# 고객 홈 페이지 진단 및 리팩토링 계획서

> **작성일**: 2026-01-25  
> **대상**: `/guest/[token]` 홈 페이지  
> **목표**: 정보 위계 최적화, 상태별 맞춤 UI, 사용성 향상

---

## 1. 현재 구조 분석

### 1.1 컴포넌트 구성 (순서대로)

```
┌─────────────────────────────────────┐
│           Hero Section              │  ← 환영 메시지, 체류 기간
├─────────────────────────────────────┤
│        GuestAnnouncements           │  ← 긴급/일반 공지 (복잡)
├─────────────────────────────────────┤
│         QuickActionGrid             │  ← 2x2 버튼 그리드
├─────────────────────────────────────┤
│       SectionDivider (brand)        │  ← 웨이브 구분선
├─────────────────────────────────────┤
│          FloorPlanCard              │  ← 약도 (체크인 후만)
├─────────────────────────────────────┤
│   ┌─────────┐  ┌─────────┐          │
│   │ WiFiCard│  │TimeCard │          │  ← Status Cards Grid
│   └─────────┘  └─────────┘          │
│   ┌─────────────────────┐           │
│   │    CheckInOut       │           │  ← 3번째 카드 (불균형)
│   └─────────────────────┘           │
├─────────────────────────────────────┤
│      SectionDivider (minimal)       │
├─────────────────────────────────────┤
│        CheckoutReminder             │  ← 알림 배너
├─────────────────────────────────────┤
│       RecentOrdersSummary           │  ← 최근 주문
└─────────────────────────────────────┘
```

### 1.2 발견된 문제점

| 영역 | 문제 | 심각도 |
|------|------|--------|
| **정보 위계** | 공지사항이 너무 상단에 위치해 핵심 액션 가림 | 🔴 높음 |
| **중복 요소** | WiFi/체크인이 Quick Actions와 Status Cards 양쪽에 존재 | 🟡 중간 |
| **그리드 불균형** | Status Cards가 3개라 모바일에서 한 칸 비어 보임 | 🟡 중간 |
| **상태별 최적화 부족** | 체크인 전/중/후 동일 UI | 🔴 높음 |
| **CheckoutReminder 위치** | 중요 알림이 페이지 하단에 묻힘 | 🟡 중간 |
| **Quick Actions 밀도** | 4개 고정으로 확장성 부족 | 🟢 낮음 |
| **코드 품질** | formatYmd가 컴포넌트 내부에 있음 | 🟢 낮음 |

---

## 2. 리팩토링 목표

### 2.1 핵심 원칙

```
✓ 상태 기반 UI — 체크인 전/중/후 맞춤 콘텐츠
✓ 정보 우선순위 — 지금 필요한 정보를 최상단에
✓ 중복 제거 — 하나의 기능은 하나의 UI로
✓ 시각적 균형 — 그리드 레이아웃 최적화
```

### 2.2 기대 효과

- **사용성 향상**: 상태별 맞춤 정보로 인지 부하 감소
- **전환율 향상**: 핵심 액션(체크인, 주문) 접근성 개선
- **유지보수 개선**: 상태 로직 분리로 코드 가독성 향상

---

## 3. 리팩토링안: 상태별 홈 구조

### 3.1 상태 정의

| 상태 | 조건 | 핵심 목표 |
|------|------|----------|
| `pre_checkin` | status !== 'checked_in' && status !== 'checked_out' | 체크인 유도 |
| `checked_in` | status === 'checked_in' | 서비스 이용 안내 |
| `checked_out` | status === 'checked_out' | 감사 인사, 재방문 유도 |

### 3.2 상태별 목업

#### A. 체크인 전 (`pre_checkin`)

```
┌─────────────────────────────────────┐
│           Hero Section              │
│    "○○님, 환영합니다"               │
│    "체크인을 진행해주세요"           │
│    [2026.01.25 — 2026.01.26]        │
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│  🔔 긴급 공지 (있을 때만)            │
│     "시설 점검 안내" — 자세히 보기    │
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│  ✅ 체크인 카드 (CTA 강조)           │
│                                     │
│  체크인 시간: 오후 3시 (15:00)       │
│  체크아웃 시간: 오전 11시 (11:00)    │
│                                     │
│  ┌───────────────────────────────┐  │
│  │     ✅ 체크인 완료하기         │  │  ← 메인 CTA
│  └───────────────────────────────┘  │
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│  📋 체크인 전 준비사항               │
│                                     │
│  • WiFi 비밀번호 확인               │
│  • 카라반 위치 안내                 │
│  • 이용 안내 가이드                 │
└─────────────────────────────────────┘

         ─────── ≋ ───────             ← 구분선

┌──────────────┐  ┌──────────────┐
│ 📶 WiFi 연결 │  │ 🔥 불멍/BBQ  │     ← 축소된 Quick Actions
└──────────────┘  └──────────────┘
┌──────────────┐  ┌──────────────┐
│ 📖 이용 안내 │  │ ❓ 도움말    │
└──────────────┘  └──────────────┘

┌─────────────────────────────────────┐
│  📢 일반 공지 (접힌 상태)            │
│     "2건의 공지가 있습니다" ▼        │
└─────────────────────────────────────┘
```

#### B. 체크인 후 (`checked_in`)

```
┌─────────────────────────────────────┐
│           Hero Section              │
│    "○○님, 편안한 스테이 되세요"     │
│    [2026.01.25 — 2026.01.26]        │
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│  🔔 체크아웃 리마인더 (상단 이동!)   │
│     "내일 오전 11시까지 체크아웃"    │
│     [알림 끄기]                     │
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│  🔔 긴급 공지 (있을 때만)            │
└─────────────────────────────────────┘

┌──────────────┐  ┌──────────────┐
│ 🔥 불멍/BBQ  │  │ 📶 WiFi 연결 │     ← 주문이 첫 번째로
└──────────────┘  └──────────────┘
┌──────────────┐  ┌──────────────┐
│ 📖 이용 안내 │  │ ❓ 도움말    │
└──────────────┘  └──────────────┘

         ─────── ≋ ───────

┌─────────────────────────────────────┐
│  📍 배정된 위치                      │
│     [약도 이미지]                   │
│     좌측 상단 카라반                │
└─────────────────────────────────────┘

┌──────────────┐  ┌──────────────┐
│ 📶 WiFi Info │  │ ⏰ 이용시간  │     ← 2x2 그리드로 통일
└──────────────┘  └──────────────┘

┌─────────────────────────────────────┐
│  🛒 최근 주문                        │
│     바베큐 세트 (소) — 30,000원      │
│     [주문 내역 보기]                │
└─────────────────────────────────────┘

         ─────────────────

┌─────────────────────────────────────┐
│  ✅ 체크인 완료 · 체크아웃하기 ▶    │  ← 하단으로 이동
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│  📢 일반 공지 (접힌 상태)            │
└─────────────────────────────────────┘
```

#### C. 체크아웃 후 (`checked_out`)

```
┌─────────────────────────────────────┐
│           Hero Section              │
│    "○○님, 감사합니다"               │
│    "안전한 귀가 되세요"              │
│    [2026.01.25 — 2026.01.26]        │
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│  🙏 체크아웃 완료                    │
│                                     │
│  즐거운 시간이 되셨기를 바랍니다.    │
│  다음에 또 찾아주세요!              │
│                                     │
│  ┌───────────────────────────────┐  │
│  │     ⭐ 후기 남기기 (선택)      │  │
│  └───────────────────────────────┘  │
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│  📋 이번 방문 요약                   │
│                                     │
│  체류 기간: 1박 2일                 │
│  이용 내역: 바베큐 세트 1회         │
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│  📱 오우스카라반 SNS                 │
│     [인스타그램] [블로그]           │
└─────────────────────────────────────┘
```

---

## 4. 컴포넌트 설계

### 4.1 새로운 컴포넌트 구조

```
components/guest/
├── GuestHomeContent.tsx          # 상태별 라우팅
├── home/
│   ├── PreCheckinHome.tsx        # 체크인 전 홈
│   ├── CheckedInHome.tsx         # 체크인 후 홈
│   ├── CheckedOutHome.tsx        # 체크아웃 후 홈
│   ├── HeroSection.tsx           # 상태별 Hero (분리)
│   ├── CheckInCTA.tsx            # 체크인 CTA 카드
│   ├── QuickActionsCompact.tsx   # 상태별 Quick Actions
│   ├── ServiceCardsGrid.tsx      # WiFi + 시간 2x2 그리드
│   └── CriticalAnnouncement.tsx  # 긴급 공지만 분리
```

### 4.2 상태별 렌더링 로직

```tsx
// GuestHomeContent.tsx
export function GuestHomeContent({ reservation, token }: GuestHomeContentProps) {
  const status = reservation.status;
  
  if (status === 'checked_out') {
    return <CheckedOutHome reservation={reservation} token={token} />;
  }
  
  if (status === 'checked_in') {
    return <CheckedInHome reservation={reservation} token={token} />;
  }
  
  return <PreCheckinHome reservation={reservation} token={token} />;
}
```

### 4.3 Quick Actions 상태별 구성

```tsx
// 체크인 전
const PRE_CHECKIN_ACTIONS = [
  { key: 'wifi', title: 'WiFi 연결', icon: Wifi },
  { key: 'order', title: '불멍/BBQ', icon: Flame },
  { key: 'guide', title: '이용 안내', icon: BookOpen },
  { key: 'help', title: '도움말', icon: HelpCircle },
];

// 체크인 후 (주문이 첫 번째)
const CHECKED_IN_ACTIONS = [
  { key: 'order', title: '불멍/BBQ', icon: Flame },
  { key: 'wifi', title: 'WiFi 연결', icon: Wifi },
  { key: 'guide', title: '이용 안내', icon: BookOpen },
  { key: 'help', title: '도움말', icon: HelpCircle },
];
```

---

## 5. 세부 변경 사항

### 5.1 Hero Section 개선

| 항목 | 현재 | 변경 |
|------|------|------|
| **서브타이틀** | 상태별 프리셋 | 상태별 맞춤 메시지 강화 |
| **배경** | 단색 흰색 | 상태별 서브틀 그라데이션 |
| **액션** | 없음 | 체크인 전: 체크인 버튼, 체크아웃 후: 후기 버튼 |

### 5.2 공지사항 간소화

**현재 문제:**
- 긴급 + 일반 공지가 한 섹션에 복잡하게 구성
- 접기/펼치기, 읽음 상태 등 기능 과다

**변경안:**
```tsx
// 긴급 공지만 별도 컴포넌트로 분리
<CriticalAnnouncement announcement={critical} />

// 일반 공지는 최하단에 접힌 상태로
<CollapsedAnnouncements 
  announcements={normal} 
  defaultExpanded={false}
/>
```

### 5.3 Status Cards 그리드 정리

**현재:** 3개 카드 (WiFi, 시간, 체크인/아웃) → 불균형

**변경안:**
```
체크인 전:
┌──────────────┐  ┌──────────────┐
│  WiFi Info   │  │  이용 시간   │   ← 2개만 (체크인은 상단 CTA로)
└──────────────┘  └──────────────┘

체크인 후:
┌──────────────┐  ┌──────────────┐
│  WiFi Info   │  │  이용 시간   │   ← 2개 유지
└──────────────┘  └──────────────┘
┌─────────────────────────────────┐
│  체크인 완료 · 체크아웃하기 ▶   │   ← 하단 별도 배치
└─────────────────────────────────┘
```

### 5.4 CheckoutReminder 위치 변경

**현재:** 페이지 하단 (노출도 낮음)

**변경안:** 체크인 후 Hero 바로 아래 (최우선 노출)

---

## 6. 구현 우선순위

| 순위 | 작업 | 난이도 | 영향도 |
|------|------|--------|--------|
| P0 | 상태별 홈 분리 (3개 컴포넌트) | 중 | 높음 |
| P0 | CheckoutReminder 위치 변경 | 하 | 중 |
| P1 | Quick Actions 상태별 순서 변경 | 하 | 중 |
| P1 | Status Cards 그리드 2x2 통일 | 하 | 중 |
| P1 | 공지사항 긴급/일반 분리 | 중 | 중 |
| P2 | Hero 상태별 스타일 강화 | 하 | 낮음 |
| P2 | 체크아웃 후 후기/SNS 섹션 | 하 | 낮음 |

---

## 7. 마이그레이션 전략

### 7.1 단계별 적용

```
Phase 1: 구조 분리 (Breaking Change 최소화)
├── GuestHomeContent.tsx 상태별 분기 추가
├── CheckoutReminder 위치만 변경
└── 기존 컴포넌트 재사용

Phase 2: 컴포넌트 최적화
├── 상태별 전용 컴포넌트 생성
├── Quick Actions 상태별 구성
└── Status Cards 그리드 정리

Phase 3: 마무리
├── 공지사항 리팩토링
├── 체크아웃 후 화면 구현
└── 코드 정리 및 테스트
```

### 7.2 롤백 전략

- 각 Phase는 독립적으로 배포 가능
- Feature flag로 새 UI 점진적 활성화 가능
- 기존 컴포넌트는 삭제하지 않고 deprecated 처리

---

## 8. 예상 작업량

| Phase | 예상 파일 수 | 신규/수정 |
|-------|-------------|-----------|
| Phase 1 | 3개 | 수정 2, 신규 1 |
| Phase 2 | 8개 | 수정 3, 신규 5 |
| Phase 3 | 5개 | 수정 3, 신규 2 |
| **합계** | **16개** | **수정 8, 신규 8** |

---

## 9. 결론

현재 고객 홈 페이지는 **"모든 상태에 동일한 UI"**를 제공하고 있어 사용자 경험이 최적화되지 않았습니다. 

**핵심 개선 방향:**
1. **상태별 맞춤 홈** — 지금 필요한 정보만 우선 노출
2. **정보 위계 재정립** — 중요한 알림(체크아웃)은 상단으로
3. **중복 제거** — 체크인/아웃 카드를 상황에 맞게 배치
4. **그리드 균형** — 2x2 통일로 시각적 안정감

이 리팩토링을 통해 **체크인 전환율 향상**, **서비스 주문 접근성 개선**, **사용자 만족도 향상**을 기대할 수 있습니다.
