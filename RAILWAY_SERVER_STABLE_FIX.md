# Railway μ„λ²„ μ•μ •ν™” μµμΆ… ν•΄κ²° κ°€μ΄λ“

## β… ν„μ¬ μƒνƒ

**ν™•μΈλ μ‚¬ν•­:**
- β… Health check μ„±κ³µ: `{"status":"ok",...}`
- β… μ„λ²„κ°€ μ •μƒμ μΌλ΅ μ‹μ‘λ¨: "Server is running on port 8080"
- β… λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²° μ„±κ³µ: "Database connected successfully"
- β μ„λ²„κ°€ μ‹μ‘ μ§ν›„ μΆ…λ£λ¨: "Stopping Container" β†’ SIGTERM

**PORT μ„¤μ •:**
- β… `parseInt(process.env.PORT || '3000', 10)` μ‚¬μ© κ°€λ¥
- Railwayκ°€ `PORT=8080`μ„ μ„¤μ •ν•λ©΄ μλ™μΌλ΅ 8080 μ‚¬μ©
- Railwayκ°€ μ„¤μ •ν•μ§€ μ•μΌλ©΄ κΈ°λ³Έκ°’ 3000 μ‚¬μ©

---

## π” λ¬Έμ  μ›μΈ λ¶„μ„

### κ°€λ¥ν• μ›μΈλ“¤:

1. **Railway λ¦¬μ†μ¤ μ ν• (κ°€μ¥ κ°€λ¥μ„± λ†’μ)**
   - λ©”λ¨λ¦¬ λ¶€μ΅± (OOMKilled)
   - CPU μ ν• λ„λ‹¬
   - Railway Metricsμ—μ„ ν™•μΈ ν•„μ”

2. **Railway μ„λΉ„μ¤ μ¬μ‹μ‘ μ •μ±…**
   - μλ™ μ¬μ‹μ‘μ΄ λ„λ¬΄ κ³µκ²©μ 
   - λ°°ν¬ νƒ€μ„μ•„μ›ƒμ΄ λ„λ¬΄ μ§§μ

3. **Railway ν—¬μ¤μ²΄ν¬ (λΉ„ν™μ„±ν™”λμ–΄ μμ§€λ§ ν™•μΈ ν•„μ”)**
   - ν—¬μ¤μ²΄ν¬κ°€ ν™μ„±ν™”λμ–΄ μμ„ μ μμ
   - ν—¬μ¤μ²΄ν¬ κ²½λ΅/ν¬νΈκ°€ μλ» μ„¤μ •λ¨

---

## β… ν•΄κ²° λ°©λ²•

### λ°©λ²• 1: Railway Metrics ν™•μΈ (μ°μ„ μμ„ 1)

**Railway λ€μ‹λ³΄λ“ β†’ OUSCARAVAN μ„λΉ„μ¤ β†’ Metrics:**

**ν™•μΈν•  λ‚΄μ©:**
1. **λ©”λ¨λ¦¬ μ‚¬μ©λ‰:**
   - ν„μ¬ λ©”λ¨λ¦¬ μ‚¬μ©λ‰ ν™•μΈ
   - λ©”λ¨λ¦¬ μ ν• ν™•μΈ
   - OOMKilled λ°μƒ μ—¬λ¶€ ν™•μΈ

2. **CPU μ‚¬μ©λ‰:**
   - ν„μ¬ CPU μ‚¬μ©λ‰ ν™•μΈ
   - CPU μ ν• ν™•μΈ

**ν•΄κ²° λ°©λ²•:**
- λ©”λ¨λ¦¬/CPU μ ν•μ΄ λ‚®μΌλ©΄ μ¦κ°€
- Railway λ€μ‹λ³΄λ“ β†’ OUSCARAVAN β†’ Settings β†’ λ¦¬μ†μ¤ μ ν• μ¦κ°€

---

### λ°©λ²• 2: Railway μ„λΉ„μ¤ μ¬μ‹μ‘ μ •μ±… ν™•μΈ (μ°μ„ μμ„ 2)

**Railway λ€μ‹λ³΄λ“ β†’ OUSCARAVAN μ„λΉ„μ¤ β†’ Settings:**

**ν™•μΈν•  λ‚΄μ©:**
1. **Restart Policy:**
   - μλ™ μ¬μ‹μ‘ μ •μ±… ν™•μΈ
   - ν•„μ”μ‹ μ΅°μ •

2. **Deployment μ„¤μ •:**
   - λ°°ν¬ νƒ€μ„μ•„μ›ƒ ν™•μΈ
   - λ΅¤λ§ μ—…λ°μ΄νΈ μ •μ±… ν™•μΈ

**ν•΄κ²° λ°©λ²•:**
- μ¬μ‹μ‘ μ •μ±… μ΅°μ •
- λ°°ν¬ νƒ€μ„μ•„μ›ƒ μ¦κ°€

---

### λ°©λ²• 3: Railway ν—¬μ¤μ²΄ν¬ ν™•μΈ (μ°μ„ μμ„ 3)

**Railway λ€μ‹λ³΄λ“ β†’ OUSCARAVAN μ„λΉ„μ¤ β†’ Settings:**

**ν™•μΈν•  λ‚΄μ©:**
1. **Health Check Path:**
   - ν—¬μ¤μ²΄ν¬κ°€ ν™μ„±ν™”λμ–΄ μλ”μ§€ ν™•μΈ
   - κ²½λ΅κ°€ `/` λλ” `/health`λ΅ μ„¤μ •λμ–΄ μλ”μ§€ ν™•μΈ

2. **Health Check Port:**
   - ν¬νΈκ°€ `8080`μΌλ΅ μ„¤μ •λμ–΄ μλ”μ§€ ν™•μΈ

**ν•΄κ²° λ°©λ²•:**
- ν—¬μ¤μ²΄ν¬ λΉ„ν™μ„±ν™” λλ” κ²½λ΅/ν¬νΈ μ¬λ°”λ¥΄κ² μ„¤μ •

---

## π€ λΉ λ¥Έ ν•΄κ²° λ°©λ²•

### λ‹¨κ³„λ³„ κ°€μ΄λ“:

1. **Railway λ€μ‹λ³΄λ“ β†’ OUSCARAVAN μ„λΉ„μ¤ β†’ Metrics**
   - λ©”λ¨λ¦¬/CPU μ‚¬μ©λ‰ ν™•μΈ
   - OOMKilled λ°μƒ μ—¬λ¶€ ν™•μΈ

2. **Railway λ€μ‹λ³΄λ“ β†’ OUSCARAVAN μ„λΉ„μ¤ β†’ Settings**
   - λ¦¬μ†μ¤ μ ν• ν™•μΈ λ° μ¦κ°€ (ν•„μ”μ‹)
   - Restart Policy ν™•μΈ
   - Health Check μ„¤μ • ν™•μΈ

3. **Railway λ€μ‹λ³΄λ“ β†’ OUSCARAVAN μ„λΉ„μ¤ β†’ Deployments**
   - "Redeploy" ν΄λ¦­
   - λ°°ν¬ μ™„λ£ λ€κΈ°

4. **Railway λ€μ‹λ³΄λ“ β†’ OUSCARAVAN μ„λΉ„μ¤ β†’ Logs**
   - "Stopping Container" λ©”μ‹μ§€κ°€ μ‚¬λΌμ΅λ”μ§€ ν™•μΈ
   - μ„λ²„κ°€ κ³„μ† μ‹¤ν–‰ μ¤‘μΈμ§€ ν™•μΈ

---

## π“‹ μ²΄ν¬λ¦¬μ¤νΈ

### Railway λ€μ‹λ³΄λ“μ—μ„ ν™•μΈ:

- [ ] OUSCARAVAN μ„λΉ„μ¤ β†’ Metrics β†’ λ©”λ¨λ¦¬/CPU μ‚¬μ©λ‰ ν™•μΈ
- [ ] OUSCARAVAN μ„λΉ„μ¤ β†’ Metrics β†’ OOMKilled λ°μƒ μ—¬λ¶€ ν™•μΈ
- [ ] OUSCARAVAN μ„λΉ„μ¤ β†’ Settings β†’ λ¦¬μ†μ¤ μ ν• ν™•μΈ
- [ ] OUSCARAVAN μ„λΉ„μ¤ β†’ Settings β†’ Restart Policy ν™•μΈ
- [ ] OUSCARAVAN μ„λΉ„μ¤ β†’ Settings β†’ Health Check μ„¤μ • ν™•μΈ
- [ ] OUSCARAVAN μ„λΉ„μ¤ β†’ Deployments β†’ Redeploy
- [ ] OUSCARAVAN μ„λΉ„μ¤ β†’ Logs β†’ "Stopping Container" λ©”μ‹μ§€ μ—†μ ν™•μΈ

### μ½”λ“ ν™•μΈ:

- [x] PORT νƒ€μ… λ³€ν™ μ™„λ£ β…
- [x] Graceful shutdown νƒ€μ„μ•„μ›ƒ μ¶”κ°€ μ™„λ£ β…
- [x] pool.end() μ½λ°± μμ • μ™„λ£ β…

---

## π’΅ μ¶”κ°€ ν™•μΈ μ‚¬ν•­

### Railway Metricsμ—μ„ ν™•μΈν•  λ‚΄μ©:

**λ©”λ¨λ¦¬ μ‚¬μ©λ‰:**
- ν„μ¬ μ‚¬μ©λ‰: ? MB
- μ ν•: ? MB
- OOMKilled λ°μƒ: Yes/No

**CPU μ‚¬μ©λ‰:**
- ν„μ¬ μ‚¬μ©λ‰: ? vCPU
- μ ν•: ? vCPU

**κ²°κ³Όμ— λ”°λ¥Έ μ΅°μΉ:**
- λ©”λ¨λ¦¬/CPUκ°€ μ ν•μ— λ„λ‹¬ν–λ‹¤λ©΄ β†’ λ¦¬μ†μ¤ μ¦κ°€
- OOMKilledκ°€ λ°μƒν–λ‹¤λ©΄ β†’ λ©”λ¨λ¦¬ μ¦κ°€ λλ” μ½”λ“ μµμ ν™”
- λ¦¬μ†μ¤κ°€ μ¶©λ¶„ν•λ‹¤λ©΄ β†’ λ‹¤λ¥Έ μ›μΈ ν™•μΈ (μ¬μ‹μ‘ μ •μ±…, ν—¬μ¤μ²΄ν¬ λ“±)

---

**λ¬Έμ„ λ²„μ „**: 1.0  
**μµμΆ… μ—…λ°μ΄νΈ**: 2024-01-15
