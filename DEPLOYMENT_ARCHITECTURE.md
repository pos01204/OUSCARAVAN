# ë°°í¬ ì•„í‚¤í…ì²˜ ê°€ì´ë“œ

## ğŸ“‹ ë°°í¬ êµ¬ì¡° ê°œìš”

### ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì‚¬ìš©ì ì ‘ê·¼                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ê´€ë¦¬ì í˜ì´ì§€  â”‚            â”‚  ê³ ê° ì „ìš© í˜ì´ì§€ â”‚
â”‚   (Vercel)    â”‚            â”‚    (Vercel)     â”‚
â”‚               â”‚            â”‚                 â”‚
â”‚ /admin/*      â”‚            â”‚ /guest/[token]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                               â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ Railway ë°±ì—”ë“œ  â”‚
                â”‚   (API ì„œë²„)    â”‚
                â”‚                â”‚
                â”‚ /api/admin/*   â”‚
                â”‚ /api/guest/*   â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚   ë°ì´í„°ë² ì´ìŠ¤   â”‚
                â”‚  (Railway PG)  â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ìë™í™” ì‹œìŠ¤í…œ                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  n8n Cloud     â”‚            â”‚    SolAPI       â”‚
â”‚  (ì›Œí¬í”Œë¡œìš°)   â”‚            â”‚  (ì•Œë¦¼í†¡ ë°œì†¡)   â”‚
â”‚                â”‚            â”‚                 â”‚
â”‚ Gmail Trigger  â”‚            â”‚ ì•Œë¦¼í†¡ API       â”‚
â”‚ Webhook        â”‚            â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ Railway ë°±ì—”ë“œ  â”‚
                â”‚   (API ì„œë²„)    â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ ë°°í¬ í™˜ê²½

### 1. Vercel (í”„ë¡ íŠ¸ì—”ë“œ)

**ë°°í¬ ëŒ€ìƒ:**
- ê´€ë¦¬ì í˜ì´ì§€
- ê³ ê° ì „ìš© í˜ì´ì§€

**ë„ë©”ì¸ êµ¬ì¡° (ë‹¨ì¼ í”„ë¡œì íŠ¸):**
- ë©”ì¸ ë„ë©”ì¸: `https://ouscaravan.vercel.app`
- ê´€ë¦¬ì í˜ì´ì§€: `https://ouscaravan.vercel.app/admin/*`
- ê³ ê° í˜ì´ì§€: `https://ouscaravan.vercel.app/guest/[token]`
- **í•˜ë‚˜ì˜ Vercel í”„ë¡œì íŠ¸ë¡œ ëª¨ë‘ ë°°í¬**

**í™˜ê²½ ë³€ìˆ˜:**
```env
# Railway ë°±ì—”ë“œ API URL
NEXT_PUBLIC_API_URL=https://ouscaravan-api.railway.app

# ê´€ë¦¬ì ì¸ì¦
NEXTAUTH_SECRET=your-secret-key
NEXTAUTH_URL=https://ouscaravan.vercel.app

# ê¸°íƒ€
NEXT_PUBLIC_WEB_APP_URL=https://ouscaravan.vercel.app
```

**ë°°í¬ ì„¤ì •:**
- Framework: Next.js
- Build Command: `npm run build`
- Output Directory: `.next`
- Install Command: `npm install`

### 2. Railway (ë°±ì—”ë“œ)

**ë°°í¬ ëŒ€ìƒ:**
- API ì„œë²„
- ë°ì´í„°ë² ì´ìŠ¤ (Postgres)

**ì„œë¹„ìŠ¤ êµ¬ì¡°:**
1. **API ì„œë²„** (Node.js/Express ë˜ëŠ” Next.js API)
   - ë„ë©”ì¸: `https://ouscaravan-api.railway.app`
   - í¬íŠ¸: Railwayê°€ ìë™ í• ë‹¹

2. **ë°ì´í„°ë² ì´ìŠ¤** (Postgres)
   - Railway Postgres ì„œë¹„ìŠ¤ ì‚¬ìš©
   - ì—°ê²° ì •ë³´ëŠ” í™˜ê²½ ë³€ìˆ˜ë¡œ ê´€ë¦¬

**í™˜ê²½ ë³€ìˆ˜:**
```env
# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
DATABASE_URL=postgresql://user:password@host:port/dbname

# API í‚¤
ADMIN_API_KEY=your-admin-api-key
N8N_WEBHOOK_URL=https://your-n8n-instance.com/webhook/reservation-assigned

# SolAPI (n8nì—ì„œ ì‚¬ìš©í•˜ë¯€ë¡œ ì„ íƒì‚¬í•­)
SOLAPI_API_KEY=your-solapi-key
SOLAPI_API_SECRET=your-solapi-secret

# ê¸°íƒ€
NODE_ENV=production
PORT=3000
```

**ë°°í¬ ì„¤ì •:**
- Runtime: Node.js
- Start Command: `npm start` ë˜ëŠ” `node server.js`
- Build Command: `npm run build` (í•„ìš”ì‹œ)

### 3. n8n Cloud (ì›Œí¬í”Œë¡œìš°)

**ë°°í¬ ëŒ€ìƒ:**
- ìë™í™” ì›Œí¬í”Œë¡œìš°

**í™˜ê²½ ë³€ìˆ˜:**
```env
# Railway ë°±ì—”ë“œ API
RAILWAY_API_URL=https://ouscaravan-api.railway.app
RAILWAY_API_KEY=your-railway-api-key

# SolAPI
SOLAPI_ALIMTALK_TEMPLATE_ID=your-template-id

# ì›¹ ì•± URL
WEB_APP_URL=https://ouscaravan.vercel.app
```

---

## ğŸ”„ ë°ì´í„° íë¦„

### 1. ì˜ˆì•½ í™•ì • ì´ë©”ì¼ ì²˜ë¦¬

```
[Gmail] 
  â†’ [n8n Gmail Trigger]
  â†’ [n8n Code: ì´ë©”ì¼ íŒŒì‹±]
  â†’ [n8n HTTP Request: Railway API]
  â†’ [Railway ë°±ì—”ë“œ]
  â†’ [ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥]
```

### 2. ê´€ë¦¬ì í˜ì´ì§€ ì‘ì—…

```
[ê´€ë¦¬ì ë¸Œë¼ìš°ì €]
  â†’ [Vercel ê´€ë¦¬ì í˜ì´ì§€]
  â†’ [Railway ë°±ì—”ë“œ API í˜¸ì¶œ]
  â†’ [ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒ/ìˆ˜ì •]
  â†’ [n8n Webhook í˜¸ì¶œ]
  â†’ [n8n ì›Œí¬í”Œë¡œìš° ì‹¤í–‰]
  â†’ [SolAPI ì•Œë¦¼í†¡ ë°œì†¡]
```

### 3. ê³ ê° í˜ì´ì§€ ì ‘ê·¼

```
[ê³ ê° ë¸Œë¼ìš°ì €]
  â†’ [Vercel ê³ ê° í˜ì´ì§€]
  â†’ [Railway ë°±ì—”ë“œ API í˜¸ì¶œ]
  â†’ [ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒ]
  â†’ [í˜ì´ì§€ ë Œë”ë§]
```

---

## ğŸ” ë³´ì•ˆ ì„¤ì •

### CORS ì„¤ì • (Railway ë°±ì—”ë“œ)

```typescript
// Railway ë°±ì—”ë“œì—ì„œ CORS ì„¤ì •
const corsOptions = {
  origin: [
    'https://ouscaravan.vercel.app',  // ë‹¨ì¼ ë„ë©”ì¸ (ê´€ë¦¬ì/ê³ ê° ëª¨ë‘)
    'http://localhost:3000'           // ë¡œì»¬ ê°œë°œ
  ],
  credentials: true
};
```

### API ì¸ì¦

**ê´€ë¦¬ì API:**
- Bearer Token ì¸ì¦
- Railway í™˜ê²½ ë³€ìˆ˜ì— ì €ì¥

**ê³ ê° API:**
- í† í° ê¸°ë°˜ ì¸ì¦
- í† í°ì€ URL íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬

---

## ğŸ“Š ëª¨ë‹ˆí„°ë§

### Vercel
- ë°°í¬ ìƒíƒœ í™•ì¸
- ì—ëŸ¬ ë¡œê·¸ í™•ì¸
- ì„±ëŠ¥ ë©”íŠ¸ë¦­

### Railway
- ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
- ë¡œê·¸ í™•ì¸
- ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§

### n8n
- ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ë¡œê·¸
- ì—ëŸ¬ ì•Œë¦¼

---

**ë¬¸ì„œ ë²„ì „**: 1.0  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2024-01-15
