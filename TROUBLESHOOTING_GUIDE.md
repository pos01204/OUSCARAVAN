# 트러블슈팅 가이드

## 📋 개요

이 문서는 OUSCARAVAN 예약 관리 시스템에서 발생할 수 있는 문제와 해결 방법을 정리합니다.

---

## 🔐 인증 관련 문제

### 문제 1: 로그인이 안 됩니다

**증상**:
- 로그인 버튼을 클릭해도 반응이 없음
- "인증 실패" 메시지 표시
- 로그인 후에도 계속 로그인 페이지로 리다이렉트

**해결 방법**:

1. **로그인 정보 확인**
   - 아이디: `ouscaravan`
   - 비밀번호: `123456789a`
   - 대소문자 구분 확인

2. **브라우저 캐시 및 쿠키 확인**
   ```bash
   # 브라우저 개발자 도구 (F12)
   # Application → Cookies 확인
   # admin-token 쿠키가 있는지 확인
   ```

3. **쿠키 차단 확인**
   - 브라우저 설정에서 쿠키가 차단되어 있지 않은지 확인
   - 시크릿 모드에서 테스트

4. **네트워크 확인**
   - 인터넷 연결 확인
   - 방화벽 설정 확인

---

### 문제 2: 로그인 후 자동으로 로그아웃됩니다

**증상**:
- 로그인 후 잠시 후 자동으로 로그아웃
- 페이지 새로고침 시 로그인 페이지로 이동

**해결 방법**:

1. **쿠키 만료 시간 확인**
   - `lib/auth.ts`에서 쿠키 설정 확인
   - `maxAge` 값 확인

2. **세션 관리 확인**
   - Railway API의 세션 관리 확인
   - 토큰 만료 시간 확인

3. **브라우저 쿠키 설정 확인**
   - 브라우저에서 쿠키가 자동 삭제되지 않는지 확인

---

## 📡 API 연결 문제

### 문제 3: 데이터가 로드되지 않습니다

**증상**:
- 예약 목록이 비어 있음
- 통계 데이터가 0으로 표시됨
- "네트워크 오류" 메시지 표시

**해결 방법**:

1. **Railway API 서버 상태 확인**
   ```bash
   # Railway API URL 확인
   curl https://ouscaravan-api.railway.app/health
   ```

2. **환경 변수 확인**
   - Vercel 대시보드에서 `NEXT_PUBLIC_API_URL` 확인
   - 올바른 Railway API URL이 설정되어 있는지 확인

3. **네트워크 연결 확인**
   - 인터넷 연결 확인
   - CORS 설정 확인 (Railway API)

4. **API 응답 확인**
   - 브라우저 개발자 도구 → Network 탭
   - API 요청의 응답 상태 확인
   - 에러 메시지 확인

---

### 문제 4: API 요청 타임아웃

**증상**:
- "요청 시간이 초과되었습니다" 메시지 표시
- 데이터 로딩이 매우 느림

**해결 방법**:

1. **타임아웃 설정 확인**
   - `lib/constants.ts`에서 `API_CONFIG.timeout` 확인
   - 기본값: 10초

2. **Railway API 서버 성능 확인**
   - Railway 대시보드에서 서버 로그 확인
   - 서버 응답 시간 확인

3. **네트워크 상태 확인**
   - 인터넷 연결 속도 확인
   - VPN 사용 시 비활성화 후 테스트

---

## 🏠 방 관리 문제

### 문제 5: 방을 삭제할 수 없습니다

**증상**:
- 방 삭제 버튼 클릭 시 에러 발생
- 삭제 확인 후에도 방이 삭제되지 않음

**해결 방법**:

1. **방 사용 여부 확인**
   - 해당 방을 사용하는 예약이 있는지 확인
   - 예약 관리 페이지에서 방 이름으로 검색

2. **Railway API 확인**
   - Railway API의 방 삭제 엔드포인트 확인
   - API 응답 에러 메시지 확인

3. **권한 확인**
   - 관리자 권한 확인
   - API 인증 토큰 확인

---

## 📅 예약 관리 문제

### 문제 6: 알림톡이 발송되지 않습니다

**증상**:
- 예약 저장 후 알림톡이 발송되지 않음
- n8n Webhook 호출 실패

**해결 방법**:

1. **n8n Webhook URL 확인**
   - Vercel 환경 변수에서 `NEXT_PUBLIC_N8N_WEBHOOK_URL` 확인
   - 올바른 Webhook URL이 설정되어 있는지 확인

2. **전화번호 형식 확인**
   - 전화번호가 올바른 형식으로 입력되었는지 확인
   - 한국 전화번호 형식: 010-1234-5678

3. **n8n 워크플로우 확인**
   - n8n 대시보드에서 워크플로우 활성화 확인
   - Webhook Trigger 노드 확인
   - 워크플로우 실행 로그 확인

4. **토큰 생성 확인**
   - 예약에 고유 토큰이 생성되었는지 확인
   - 토큰이 없으면 알림톡 링크 생성 실패

---

### 문제 7: 예약 상태가 업데이트되지 않습니다

**증상**:
- 예약 상태 변경 후 저장해도 변경되지 않음
- 상태 변경 버튼이 작동하지 않음

**해결 방법**:

1. **Railway API 확인**
   - API 요청이 성공적으로 전송되었는지 확인
   - API 응답 확인

2. **브라우저 새로고침**
   - 페이지를 새로고침하여 최신 데이터 확인

3. **네트워크 확인**
   - 네트워크 연결 확인
   - API 서버 상태 확인

---

## 🛒 주문 관리 문제

### 문제 8: 주문 상태가 업데이트되지 않습니다

**증상**:
- 주문 상태 변경 버튼 클릭 시 반응 없음
- 상태 변경 후에도 이전 상태로 표시됨

**해결 방법**:

1. **API 요청 확인**
   - 브라우저 개발자 도구 → Network 탭
   - PATCH 요청이 전송되었는지 확인
   - 응답 상태 코드 확인

2. **Railway API 확인**
   - 주문 상태 업데이트 API 엔드포인트 확인
   - API 응답 확인

3. **페이지 새로고침**
   - "새로고침" 버튼 클릭
   - 최신 데이터 확인

---

## 🎨 UI/UX 문제

### 문제 9: 모바일에서 메뉴가 표시되지 않습니다

**증상**:
- 모바일에서 햄버거 메뉴가 보이지 않음
- 메뉴 클릭 시 반응 없음

**해결 방법**:

1. **브라우저 캐시 삭제**
   - 브라우저 설정에서 캐시 삭제
   - 하드 새로고침 (Ctrl+Shift+R 또는 Cmd+Shift+R)

2. **JavaScript 활성화 확인**
   - 브라우저에서 JavaScript가 활성화되어 있는지 확인

3. **반응형 브레이크포인트 확인**
   - 화면 너비가 768px 미만인지 확인
   - 개발자 도구에서 모바일 뷰 확인

---

### 문제 10: 이미지가 표시되지 않습니다

**증상**:
- 메뉴 이미지, BBQ 가이드 이미지가 표시되지 않음
- 이미지 대신 플레이스홀더만 표시됨

**해결 방법**:

1. **이미지 파일 확인**
   - `public/images/` 디렉토리에 이미지 파일이 있는지 확인
   - 이미지 경로가 올바른지 확인

2. **이미지 최적화 확인**
   - Next.js Image 컴포넌트 사용 확인
   - 이미지 형식 확인 (WebP, JPG, PNG)

3. **CDN 또는 외부 이미지 확인**
   - 외부 이미지 URL인 경우 접근 가능한지 확인
   - CORS 설정 확인

---

## 🔧 기술적 문제

### 문제 11: 빌드 오류

**증상**:
- `npm run build` 실행 시 오류 발생
- Vercel 배포 실패

**해결 방법**:

1. **TypeScript 오류 확인**
   ```bash
   npm run type-check
   ```

2. **의존성 확인**
   ```bash
   npm install
   ```

3. **환경 변수 확인**
   - `.env.local` 파일 확인
   - Vercel 환경 변수 설정 확인

4. **빌드 로그 확인**
   - Vercel 대시보드에서 빌드 로그 확인
   - 오류 메시지 확인

---

### 문제 12: 페이지가 로드되지 않습니다

**증상**:
- 페이지가 흰 화면으로 표시됨
- "페이지를 찾을 수 없습니다" 오류

**해결 방법**:

1. **라우트 확인**
   - URL이 올바른지 확인
   - Next.js 라우트 구조 확인

2. **서버 상태 확인**
   - Vercel 배포 상태 확인
   - 서버 로그 확인

3. **브라우저 콘솔 확인**
   - 개발자 도구 → Console 탭
   - JavaScript 오류 확인

---

## 📊 성능 문제

### 문제 13: 페이지 로딩이 느립니다

**증상**:
- 페이지 로딩 시간이 매우 김
- 데이터 표시가 느림

**해결 방법**:

1. **네트워크 속도 확인**
   - 인터넷 연결 속도 확인
   - VPN 사용 시 비활성화

2. **이미지 최적화 확인**
   - 이미지 크기 확인
   - Next.js Image 컴포넌트 사용 확인

3. **API 응답 시간 확인**
   - Railway API 서버 성능 확인
   - 데이터베이스 쿼리 최적화 확인

4. **캐싱 확인**
   - 브라우저 캐시 활용
   - Next.js 캐싱 설정 확인

---

## 🔗 연동 문제

### 문제 14: n8n 워크플로우가 작동하지 않습니다

**증상**:
- 예약 저장 후 알림톡이 발송되지 않음
- n8n Webhook이 트리거되지 않음

**해결 방법**:

1. **n8n Webhook URL 확인**
   - Vercel 환경 변수 확인
   - n8n Webhook URL이 올바른지 확인

2. **n8n 워크플로우 확인**
   - n8n 대시보드에서 워크플로우 활성화 확인
   - Webhook Trigger 노드 확인
   - 워크플로우 실행 로그 확인

3. **데이터 형식 확인**
   - Webhook으로 전송되는 데이터 형식 확인
   - n8n에서 기대하는 데이터 형식과 일치하는지 확인

---

## 📝 로그 확인

### 브라우저 콘솔
- 개발자 도구 (F12) → Console 탭
- JavaScript 오류 및 경고 확인

### 네트워크 요청
- 개발자 도구 (F12) → Network 탭
- API 요청 및 응답 확인
- 상태 코드 및 에러 메시지 확인

### 서버 로그
- Vercel 대시보드 → Logs
- Railway 대시보드 → Logs
- n8n 대시보드 → Execution Logs

---

## 🆘 추가 지원

문제가 해결되지 않을 경우:
1. 에러 메시지와 스크린샷 수집
2. 브라우저 콘솔 로그 수집
3. 네트워크 요청 로그 수집
4. 관리자에게 문의

---

**최종 업데이트**: 2024-01-15
