# 카카오 개발자 콘솔 설정 진단 및 가이드

## 📊 현재 상태 진단

### ✅ 완료된 설정

1. **앱 기본 정보**
   - 앱 이름: OUSCARAVAN Concierge
   - 앱 ID: 1363679
   - 앱 타입: 비즈 앱 ✅
   - 회사명: 오우스 카라반 캠핑장
   - 카테고리: 광고/비즈니스

2. **플랫폼 키**
   - REST API 키: `9975b15c5bd62ed55accd41bdb064d36` ✅
   - JavaScript 키: `04ab07189dc753db38a89c7f87ed27ba` ✅
   - Native App 키: `f5aed92dbc0e67e9f7a0c2042ef17f62` ✅

3. **어드민 키**
   - Default Admin Key: `149317239e3f21c7bf78c442a8905be9` ✅

4. **카카오 로그인**
   - 상태: 활성화됨 (ON) ✅
   - 로그아웃 Redirect URI: `https://ouscaravan.com/auth/kakao/callback` ✅
   - 사용자 아이디 고정: 활성화됨 ✅

5. **접근 권한 (동의항목)**
   - 카카오톡 메시지 전송: "이용 중 동의" ✅
   - 동의 목적: 설정 필요 ⚠️

6. **비즈니스 정보**
   - 회사명: 오우스카라반
   - 사업자 등록번호: 887-08-01964
   - 심사 상태: **심사 중** ⏳

---

## ⚠️ 진행 중인 작업

### 1. 비즈니스 정보 심사 (심사 중)

**현재 상태:**
- 심사 신청 완료
- 심사 상태: "심사 중" (파란색 점 표시)

**다음 단계:**
- 심사 완료 대기 (보통 1-3일 소요)
- 심사 완료 후 추가 기능 신청 가능

---

## 🔧 필요한 설정 작업

### 우선순위 1: 비즈니스 정보 심사 완료 대기

**현재 상태:** 심사 중 ⏳

**대기 중 확인 사항:**
- [ ] 심사 완료 알림 확인
- [ ] 심사 결과 확인 (승인/반려)

**심사 반려 시:**
- 반려 사유 확인
- 필요한 서류 추가 제출
- 재신청

---

### 우선순위 2: 서비스 화면 준비 (심사 완료 전 미리 준비)

**목적:** 비즈니스 심사 완료 후 추가 기능 신청 시 필요

#### 서비스 화면 제작 방법

**옵션 A: 웹 앱 홈 화면 + 카카오톡 메시지 (권장)**

1. **웹 앱 홈 화면 캡처**
   - URL: `https://ouscaravan.vercel.app/home?guest=테스트게스트&room=A1&checkin=2026-01-15&checkout=2026-01-17`
   - 또는 실제 배포된 도메인 사용
   - 브라우저에서 F12 → 디바이스 모드 → 모바일 뷰
   - 전체 화면 스크린샷

2. **카카오톡 메시지 모의 화면 제작**
   - PowerPoint, Figma, 또는 Canva 사용
   - 예약 완료 메시지 내용:
     ```
     홍길동님, OUSCARAVAN 예약이 완료되었습니다!
     
     예약번호: 1122269060
     📅 체크인: 2026-01-15
     📅 체크아웃: 2026-01-17
     🏠 객실: Airstream1
     💰 결제금액: 180,000원
     
     [컨시어지 서비스 이용하기] 버튼
     ```

3. **이미지 합성**
   - 상단 (50%): 웹 앱 홈 화면
   - 하단 (50%): 카카오톡 메시지 화면
   - 파일 형식: JPG 또는 PNG
   - 용량: 20MB 이내

**옵션 B: 단일 홈 화면만 제출 (간단)**

- 웹 앱 홈 화면만 캡처
- 개인정보는 테스트 데이터 사용

#### 파일 요구사항
- 형식: JPG, JPEG, PNG, PDF
- 용량: 20MB 이내
- 개수: 최대 1장
- 개인정보: 제거 (테스트 데이터 사용)

---

### 우선순위 3: 웹 도메인 등록 확인

**현재 상태 확인 필요**

**확인 방법:**
1. 왼쪽 사이드바: **"앱 설정"** → **"앱"** → **"제품 링크 관리"** 클릭
2. **"웹 도메인"** 섹션 확인
3. 등록된 도메인 확인:
   - `https://ouscaravan.vercel.app` 또는
   - `https://ouscaravan.com`

**등록되지 않은 경우:**
1. **"웹 도메인 등록"** 버튼 클릭
2. 도메인 입력:
   ```
   https://ouscaravan.vercel.app
   ```
   또는 실제 배포된 도메인
3. **저장** 클릭

**중요:** 최대 10개까지 등록 가능

---

### 우선순위 4: 카카오 로그인 Redirect URI 확인

**현재 설정:**
- 로그아웃 Redirect URI: `https://ouscaravan.com/auth/kakao/callback` ✅

**추가 확인 필요:**
1. 왼쪽 사이드바: **"제품 설정"** → **"카카오 로그인"** → **"일반"** 클릭
2. **"Redirect URI"** 섹션 확인
3. 다음 URI가 등록되어 있는지 확인:
   ```
   https://ouscaravan.com/auth/kakao/callback
   ```
   또는 실제 배포된 도메인

**등록되지 않은 경우:**
1. **"Redirect URI 추가"** 버튼 클릭
2. URI 입력
3. **저장** 클릭

**중요:** 최대 10개까지 등록 가능

---

### 우선순위 5: 카카오톡 메시지 전송 동의항목 설정 완료

**현재 상태:**
- 항목: 카카오톡 메시지 전송 / talk_message
- 동의 단계: "이용 중 동의" ✅
- 동의 목적: **입력 필요** ⚠️

**설정 방법:**
1. 왼쪽 사이드바: **"제품 설정"** → **"카카오 로그인"** → **"동의항목"** 클릭
2. **"접근권한"** 섹션에서 **"카카오톡 메시지 전송"** 찾기
3. **"설정"** 버튼 클릭
4. **"동의 목적(필수)"** 필드에 다음 입력:
   ```
   예약 완료 알림 및 컨시어지 서비스 안내를 위한 카카오톡 메시지 발송
   ```
5. **"저장"** 버튼 클릭

---

### 우선순위 6: 비즈니스 심사 완료 후 추가 기능 신청

**심사 완료 후 진행:**

#### 6-1. 카카오톡 친구 목록/메시지 추가 기능 신청

1. 왼쪽 사이드바: **"앱 설정"** → **"앱"** → **"추가 기능 신청"** 클릭
2. **"추가 기능"** 테이블에서 **"카카오톡 친구 목록/메시지"** 찾기
3. **"신청"** 버튼 클릭
4. 신청 양식 작성:
   - 서비스 정보 URL: `https://ouscaravan.vercel.app` (또는 실제 도메인)
   - 서비스 화면: 우선순위 2에서 준비한 이미지 업로드
5. **"신청"** 버튼 클릭

**심사 기간:** 보통 3-7일 소요

#### 6-2. 카카오톡 메시지 활성화 확인

1. 왼쪽 사이드바: **"제품 설정"** → **"카카오톡 메시지"** 클릭
2. 메시지 템플릿 빌더 확인
3. 메시지 템플릿 생성 (필요 시)

---

### 우선순위 7: Access Token 발급

**비즈니스 심사 및 추가 기능 신청 완료 후 진행**

#### 방법 1: 카카오 개발자 도구 사용 (권장)

1. [카카오 개발자 도구](https://developers.kakao.com/tool) 접속
2. **"REST API 테스트"** 메뉴 선택
3. **"토큰 발급"** 클릭
4. 앱 선택: **OUSCARAVAN Concierge**
5. 권한 승인
6. **access_token**과 **refresh_token** 복사

#### 방법 2: OAuth 2.0 수동 발급

1. 다음 URL로 접속 (브라우저):
   ```
   https://kauth.kakao.com/oauth/authorize?client_id=9975b15c5bd62ed55accd41bdb064d36&redirect_uri=https://ouscaravan.com/auth/kakao/callback&response_type=code&scope=talk_message
   ```
   - `client_id`: REST API 키
   - `redirect_uri`: 설정한 Redirect URI
   - `scope`: `talk_message` (카카오톡 메시지 전송 권한)

2. 권한 승인
3. 리디렉션된 URL에서 **code** 파라미터 복사
4. Postman 또는 curl로 토큰 발급:
   ```bash
   curl -X POST https://kauth.kakao.com/oauth/token \
     -H "Content-Type: application/x-www-form-urlencoded" \
     -d "grant_type=authorization_code" \
     -d "client_id=9975b15c5bd62ed55accd41bdb064d36" \
     -d "redirect_uri=https://ouscaravan.com/auth/kakao/callback" \
     -d "code=발급받은_코드"
   ```

---

### 우선순위 8: n8n 환경 변수 설정

**Access Token 발급 후 진행**

1. n8n 워크플로우 페이지 접속
2. 상단 메뉴: **Settings** (⚙️ 아이콘) 클릭
3. **"Environment Variables"** 클릭
4. 다음 변수 추가:

| Name | Value | 설명 |
|------|-------|------|
| `KAKAO_REST_API_KEY` | `9975b15c5bd62ed55accd41bdb064d36` | REST API 키 |
| `KAKAO_ACCESS_TOKEN` | (발급받은 토큰) | Access Token |
| `KAKAO_REFRESH_TOKEN` | (발급받은 토큰) | Refresh Token (선택) |
| `WEB_APP_URL` | `https://ouscaravan.vercel.app` | 웹 앱 URL |

5. 각 변수 **"Save"** 클릭

---

## 📋 단계별 체크리스트

### 즉시 진행 가능한 작업

- [ ] **카카오톡 메시지 전송 동의 목적 입력**
  - 위치: 제품 설정 → 카카오 로그인 → 동의항목 → 접근권한 → 카카오톡 메시지 전송 → 설정
  - 동의 목적: "예약 완료 알림 및 컨시어지 서비스 안내를 위한 카카오톡 메시지 발송"
  
- [ ] **웹 도메인 등록 확인**
  - 위치: 앱 설정 → 앱 → 제품 링크 관리 → 웹 도메인
  - 도메인: `https://ouscaravan.vercel.app` 또는 실제 도메인
  
- [ ] **카카오 로그인 Redirect URI 확인**
  - 위치: 제품 설정 → 카카오 로그인 → 일반
  - URI: `https://ouscaravan.com/auth/kakao/callback` 또는 실제 도메인
  
- [ ] **서비스 화면 준비**
  - 웹 앱 홈 화면 캡처
  - 카카오톡 메시지 모의 화면 제작
  - 이미지 합성 (JPG/PNG, 20MB 이내)

### 비즈니스 심사 완료 후 진행

- [ ] **비즈니스 심사 완료 확인**
  - 위치: 앱 설정 → 앱 → 추가 기능 신청 → 비즈니스 정보
  - 심사 상태: "심사 완료" 확인
  
- [ ] **카카오톡 친구 목록/메시지 추가 기능 신청**
  - 위치: 앱 설정 → 앱 → 추가 기능 신청 → 추가 기능
  - 서비스 정보 URL 입력
  - 서비스 화면 업로드
  - 신청 버튼 클릭
  
- [ ] **추가 기능 심사 완료 대기**
  - 심사 기간: 3-7일

### 추가 기능 심사 완료 후 진행

- [ ] **Access Token 발급**
  - 카카오 개발자 도구 사용
  - 또는 OAuth 2.0 수동 발급
  
- [ ] **n8n 환경 변수 설정**
  - KAKAO_REST_API_KEY
  - KAKAO_ACCESS_TOKEN
  - KAKAO_REFRESH_TOKEN (선택)
  - WEB_APP_URL
  
- [ ] **n8n HTTP Request 노드 설정**
  - 카카오톡 메시지 API 호출 설정
  - 테스트 실행

---

## 🎯 현재 화면별 상세 가이드

### 화면 1: 일반 설정

**위치:** 앱 설정 → 앱 → 일반

**확인 사항:**
- ✅ 앱 기본 정보: OUSCARAVAN Concierge
- ✅ 앱 대표 도메인: `https://ouscaravan.vercel.app`
- ✅ 비즈니스 정보: 오우스카라반, 887-08-01964

**작업:** 없음 (이미 완료)

---

### 화면 2: 플랫폼 키

**위치:** 앱 설정 → 앱 → 플랫폼 키

**확인 사항:**
- ✅ REST API 키: `9975b15c5bd62ed55accd41bdb064d36`
- ✅ JavaScript 키: `04ab07189dc753db38a89c7f87ed27ba`
- ✅ Native App 키: `f5aed92dbc0e67e9f7a0c2042ef17f62`

**작업:** 
- [ ] REST API 키 복사 (n8n 환경 변수에 사용)

---

### 화면 3: 어드민 키

**위치:** 앱 설정 → 앱 → 어드민 키

**확인 사항:**
- ✅ Default Admin Key 존재

**작업:** 없음 (서버에서만 사용)

---

### 화면 4: 제품 링크 관리

**위치:** 앱 설정 → 앱 → 제품 링크 관리

**확인 필요:**
- [ ] 웹 도메인 등록 여부
- [ ] 등록된 도메인: `https://ouscaravan.vercel.app` 또는 실제 도메인

**작업:**
- [ ] 웹 도메인 미등록 시 등록

---

### 화면 5: 추가 기능 신청

**위치:** 앱 설정 → 앱 → 추가 기능 신청

**현재 상태:**
- ⏳ 비즈니스 정보: 심사 중
- ⏸️ 카카오톡 친구 목록/메시지: 신청 대기 (비즈니스 심사 완료 후)

**작업:**
- [ ] 비즈니스 심사 완료 대기
- [ ] 서비스 화면 준비
- [ ] 심사 완료 후 카카오톡 친구 목록/메시지 신청

---

### 화면 6: 카카오 로그인 - 일반

**위치:** 제품 설정 → 카카오 로그인 → 일반

**확인 사항:**
- ✅ 사용 설정: ON
- ✅ 로그아웃 Redirect URI: `https://ouscaravan.com/auth/kakao/callback`

**추가 확인 필요:**
- [ ] Redirect URI 섹션에서 일반 Redirect URI도 등록되어 있는지 확인

**작업:**
- [ ] Redirect URI 미등록 시 추가

---

### 화면 7: 카카오 로그인 - 동의항목

**위치:** 제품 설정 → 카카오 로그인 → 동의항목

**확인 사항:**
- ✅ 카카오톡 메시지 전송: "이용 중 동의"
- ⚠️ 동의 목적: 입력 필요

**작업:**
1. **"접근권한"** 섹션에서 **"카카오톡 메시지 전송"** 찾기
2. **"설정"** 버튼 클릭
3. **"동의 목적(필수)"** 필드에 입력:
   ```
   예약 완료 알림 및 컨시어지 서비스 안내를 위한 카카오톡 메시지 발송
   ```
4. **"저장"** 버튼 클릭

---

### 화면 8: 카카오톡 메시지

**위치:** 제품 설정 → 카카오톡 메시지

**현재 상태:**
- ⚠️ 추가 기능 신청 필요 (비즈니스 심사 완료 후)

**작업:**
- [ ] 비즈니스 심사 완료 대기
- [ ] 카카오톡 친구 목록/메시지 추가 기능 신청
- [ ] 심사 완료 후 메시지 템플릿 생성

---

## 🚀 빠른 시작 가이드

### 지금 바로 할 수 있는 작업 (5분)

1. **카카오톡 메시지 전송 동의 목적 입력**
   - 제품 설정 → 카카오 로그인 → 동의항목 → 접근권한 → 카카오톡 메시지 전송 → 설정
   - 동의 목적 입력 후 저장

2. **웹 도메인 등록 확인**
   - 앱 설정 → 앱 → 제품 링크 관리 → 웹 도메인
   - 미등록 시 등록

3. **REST API 키 복사**
   - 앱 설정 → 앱 → 플랫폼 키
   - REST API 키 복사 (나중에 n8n에 사용)

### 오늘 준비할 작업 (30분)

1. **서비스 화면 제작**
   - 웹 앱 홈 화면 캡처
   - 카카오톡 메시지 모의 화면 제작
   - 이미지 합성

### 심사 완료 후 진행할 작업

1. **카카오톡 친구 목록/메시지 추가 기능 신청**
2. **Access Token 발급**
3. **n8n 환경 변수 설정**

---

## 📞 문제 해결

### 비즈니스 심사가 오래 걸리는 경우

- 심사 기간: 보통 1-3일
- 3일 이상 소요 시 카카오 고객센터 문의

### 추가 기능 신청이 거부된 경우

- 거부 사유 확인
- 서비스 화면 보완
- 서비스 정보 URL 확인
- 재신청

### Access Token 발급 실패

- 카카오 로그인 활성화 확인
- Redirect URI 확인
- 동의항목 설정 확인
- 카카오 개발자 도구에서 직접 발급 시도

---

**문서 버전**: 1.0  
**최종 업데이트**: 2024-01-15  
**다음 업데이트**: 비즈니스 심사 완료 후
