# 예약/배정 — 월 캘린더뷰 정보구조 개선안 (이름/인원실 중심)

## 목표 (운영 관점의 "한 달 한눈에")
- **월 단위에서 "그 날 누가(예약자) / 몇인실(룸타입)을 예약했는지"가 1순위로 보이게** 한다.
- 체크인/체크아웃/미배정 상태는 **2차 정보**로 내려 "필요할 때만" 확인 가능하게 한다(과도한 색/배지로 가독성 훼손 금지).
- 모바일에서도 "한 달 전체 흐름"을 유지하되, 셀 내 과밀을 **우아하게(요약 + 확장)** 처리한다.

## 현재 구조 요약 (현 코드 기준)
파일: `app/admin/reservations/ReservationCalendarView.tsx`
- 월 뷰는 `react-big-calendar`의 **바(기간) 이벤트**로 체크인~체크아웃 기간을 셀에 가로 막대로 표시.
- 이벤트 타이틀이 업무 축약(예: `미/입/퇴 + 이름`) 중심이며, 색상도 상태(`STATUS_COLORS`) 중심.
- 날짜 헤더는 요약 칩(체크인/미배정/체크아웃)을 보여주어 "상태"가 상단을 점유.

문제:
- 월 단위에서 가장 자주 보는 정보(이름/룸타입)가 **셀 안에서 후순위**로 밀림.
- 기간 이벤트(체크인~체크아웃)가 많을수록 **막대가 과밀**해져 "누가/몇인실"을 읽기 어려움.
- 상태 색상이 강할수록 '업무 상태'가 메인처럼 보여 운영자가 원하는 **명단(로스터) 감각**이 약함.

---

## 개선 방향 핵심: "월 로스터(명단) 우선" + "상태는 보조"

## 목업(와이어프레임) — 결과 확인용
아래 목업은 "월에서 바로 읽히는 정보"를 **예약자명/몇인실**로 고정하고, 과밀은 `+N 더보기`로 흡수하는 형태다.

### 1) 월 캘린더(모바일) — 셀 내부 로스터
핵심: 모바일에서도 "한 달 전체"를 보되, 셀에는 **최대 2줄 + 더보기**만 유지한다.

```
[예약 / 배정]                                 [⟳]
관리자 예약 현황 및 객실 배정 시스템

마지막 업데이트: 2026년 1월 23일 오후 07:33

2026년 1월
┌────┬────┬────┬────┬────┬────┬────┐
│ 29 │ 30 │ 31 │ 01 │ 02 │ 03 │ 04 │
│    │    │    │김*정·4│김*윤·2│도*리·4│ ...│
│    │    │    │미*구·2·미│+5 더보기│+3 더보기│    │
└────┴────┴────┴────┴────┴────┴────┘

표기 규칙:
- "이름 · N인실"이 1순위
- 미배정은 끝에 '·미'(미니 표식)만 추가
- 상태(대기/체크인/체크아웃)는 월 셀에서 숨김(상세에서 노출)
```

### 2) 월 캘린더(데스크톱) — 더 많은 행, 더 높은 가독성
핵심: 데스크톱은 셀 내부 **3~4줄**까지 허용하고, 필요하면 "체크인 n"처럼 아주 얇게 보조 요약만 추가한다.

```
2026년 1월
┌───────────── 01(목) ─────────────┐
│ 체크인 7 (보조)                  │
│ 김*정 · 4인실                    │
│ 미*구*지 · 2인실 · 미            │
│ 김*윤 · 2인실                    │
│ +4 더보기                        │
└──────────────────────────────────┘
```

### 3) "+N 더보기" / 날짜 클릭 → 인스펙터(드로어/시트)
핵심: 월에서 못 담는 정보는 인스펙터에서 해결한다. 인스펙터의 1줄은 **이름/인원실/배정/기간** 순으로 정렬한다.

```
[2026년 1월 1일 (목)]  (체크인 7건)
보기: [체크인 기준] [숙박중 전체]
정렬: [이름순] [미배정 우선]

┌──────────────────────────────────────────┐
│ 김*정   | 4인실 | (미배정)  | 1/1~1/2     │
│ 미*구*지 | 2인실 | A-03     | 1/1~1/3     │
│ 김*윤   | 2인실 | B-01     | 1/1~1/2     │
│ ...                                      │
└──────────────────────────────────────────┘

액션:
- 항목 클릭: 상세(요청사항/금액/상태) 보기
- (미배정)인 경우: "배정" 버튼 유지(기존 플로우 재사용)
```

### 4) "상태"는 어디서 보나? (월에선 숨기고, 상세에서만)
월 그리드에서는 색을 최소화하고, 상태 배지는 인스펙터 리스트/상세에서만 노출한다.

```
인스펙터 리스트(좌측: 상태배지, 우측: 로스터 정보)
[대기] 김*정 | 4인실 | (미배정) | 1/1~1/2
[배정] 미*구*지 | 2인실 | A-03  | 1/1~1/3
[체크인] 김*윤 | 2인실 | B-01   | 1/1~1/2
```

### 5) 과밀한 날짜(10건+) 처리 목업
핵심: 셀은 "정해진 줄 수"를 넘기지 않는다.

```
07(수)
김*정 · 4인실
도*리 · 2인실
+12 더보기
```

### 권장안 A) 월 뷰를 "체크인 기준 로스터 셀"로 전환 (기본값)
월 셀은 "그 날 체크인(도착)하는 예약자 명단"을 우선 노출한다.
- **셀 내 표준 표시량**: 2~4줄(모바일 2줄, 데스크톱 3~4줄)
- 각 줄: **`예약자명 · N인실`** (필요 시 `배정 객실`은 툴팁/상세에서)
- 초과 시: **`+N 더보기`** → 기존 인스펙터(드로어/시트)로 확장

#### 셀 UI 와이어(예시)
월 셀(모바일 기준):
```
01 (목)
김*정 · 4인실
미*구*지 · 2인실
+5 더보기
```

월 셀(데스크톱 기준):
```
01 (목)  체크인 7
김*정 · 4인실
미*구*지 · 2인실
김*윤 · 2인실
+4 더보기
```

#### "상태/미배정"은 이렇게만 남긴다 (과한 강조 금지)
- 미배정은 줄 끝에 **아주 작은 점/미니 배지**로만 표시: `김*정 · 4인실  · 미`
- 체크인/체크아웃 상태는 월 셀에서는 숨기고, **상세(인스펙터)에서만** 배지로 확인.

---

### 권장안 B) 월 뷰는 "숙박중(점유) 요약"으로 보고, 명단은 "월 리스트(로스터)"로 분리
운영 방식이 "도착자(체크인)"보다 "오늘 숙박중 전체"가 중요한 경우에 적합.
- 월 그리드 셀: `숙박중 X / 체크인 Y` 같은 **숫자 요약 + 색 최소화**
- 명단은 탭으로 분리된 "월 로스터 리스트"에서 확인

와이어(개념):
```
[월(요약)]  [월 로스터(명단)]
```

하지만 사용자의 요구("그 날 어떤 이름/몇인실")는 **월 그리드 자체에서 명단이 바로 보여야** 하므로,
이번 개선의 기본값은 **권장안 A**가 더 적합하다.

---

## 데이터 우선순위(정보 위계) 재정의
월 셀에서의 표시 우선순위:
1) **예약자명**
2) **룸타입(몇인실)**
3) (옵션) **미배정 여부** (미니 표식)
4) (상세에서) 체크인/체크아웃/상태/금액/요청사항

정렬(권장):
- 기본: `이름 가나다순`
- 옵션 토글: `미배정 상단 정렬` (기본 OFF; 필요 시만)

---

## 상호작용(UX) 설계
- **월 셀 클릭**: 해당 날짜 인스펙터 오픈(현 구조 유지)
- **+N 더보기 클릭**: 동일하게 인스펙터 오픈(현 구조 유지)
- 인스펙터 상단에 "보기 모드" 제공:
  - `체크인 기준`(기본)
  - `숙박중 전체`(필요 시, 이미 `getReservationsForDate(date, true)` 지원)

인스펙터 리스트의 1줄 정보(권장):
`예약자명 | N인실 | (배정객실) | 체크인~체크아웃`

---

## 구현 전략 (현 코드 기반, 변경 범위 최소)
파일: `app/admin/reservations/ReservationCalendarView.tsx`

## 구현 후 "결과 확인" 체크(수용 기준)
- 월 뷰에서 임의의 날짜를 봤을 때, **첫 시선에 읽히는 정보가 '이름/몇인실'**이어야 한다.
- 한 날짜에 예약이 많아도 셀은 **최대 2~4줄만** 사용하고, 나머지는 `+N 더보기`로 안정적으로 수렴해야 한다.
- "미배정"은 월에서 과하게 튀지 않되, 줄 끝의 `·미`로 **즉시 식별** 가능해야 한다.
- 상태(대기/체크인/체크아웃)는 월에서 주도권을 가지지 않고, 인스펙터에서 **정확히 확인** 가능해야 한다.

### 1) 이벤트를 "기간 바"에서 "체크인 단일일 이벤트"로 전환 (월 뷰 기본)
현재:
- `start = checkin`, `end = checkout(당일끝)` → 기간 이벤트로 월 셀에 막대가 길게 퍼짐

개선:
- 월 뷰 기본 모드에서는 `start = checkin`, `end = checkin(당일끝)`로 **단일일 이벤트** 생성
- 이렇게 하면 월 셀에 해당 날짜의 "명단"이 **압축적으로** 모인다.

### 2) 이벤트 타이틀을 "이름/인원실"로 교체
현재 `getEventShortTitle`: `미/입/퇴 + 이름`

개선 타이틀(예):
- `김*정 · 4인실`
- 룸타입 표기는 기존 사용 중인 `reservation.roomType.split('(')[0]` 형태를 재사용

### 3) 색상 정책 변경: 상태색 최소화 → 중립 톤 + 강조는 텍스트로
현재 `eventStyleGetter`는 `STATUS_COLORS` 배경으로 강하게 칠함.

개선:
- 월 셀 이벤트는 **중립 배경(예: `bg-muted/40`) + 얇은 보더**로 통일
- 미배정만 미니 포인트(점/테두리)로 표시
- 상태 색은 인스펙터(상세)에서만 그대로 사용해도 됨

### 4) 날짜 헤더 요약칩을 "명단 요약"으로 교체
현재 DateHeaderComponent 요약:
- 체크인/미배정/체크아웃 칩

개선 요약(권장):
- 상단에 `체크인 n` 같은 숫자 + 아래 1~2개의 샘플 명단
- 또는 숫자 없이 "명단 2줄 + +N 더보기"로만 구성(더 미니멀)

---

## 운영자가 얻는 효과
- 월 화면에서 **즉시 명단/룸타입이 읽혀** 전화 응대/현장 배정 업무가 빨라짐.
- 상태를 색으로 크게 칠하지 않아도, "필요할 때만" 인스펙터에서 확인 가능 → **인지부하 감소**.
- 기간 막대가 사라져 월 뷰가 **표(명단)처럼 정돈**되어 보임.

---

## 리스크 및 대응
- **예약이 매우 많은 날(10건+)**: 셀 과밀
  - 대응: 표시 줄 수를 고정(2~4줄) + `+N 더보기`로 강제 요약
- **숙박중(점유) 확인 니즈**도 존재
  - 대응: 인스펙터/상단에 "숙박중 전체" 토글 제공(이미 로직 존재)

---

## 적용 체크리스트 (작업 항목)
- [x] 월 뷰 기본 모드를 "체크인 로스터"로 설정 (2026-01-23 완료)
- [x] 월 셀 이벤트 타이틀: `예약자명 · N인실` (2026-01-23 완료)
- [x] 월 셀 이벤트 스타일: 중립 톤, 상태색 최소화 (2026-01-23 완료)
- [x] DateHeaderComponent: 체크인수 최소 요약으로 교체 (2026-01-23 완료)
- [x] 인스펙터에 "체크인 기준/숙박중 전체" 보기 토글 유지 (기존 로직 유지됨)
